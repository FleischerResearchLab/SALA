---

title: Plots


keywords: fastai
sidebar: home_sidebar

summary: "Utility plotting module designed to take SALA objects and provide relevant plotting tools"
description: "Utility plotting module designed to take SALA objects and provide relevant plotting tools"
nb_path: "01_plots.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_plots.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plots created within this module require particular information to be present within the data. Specifically, data related to sleep, light, or location are of importance for this dataset. Therefore, the plotting functions here take in dataframes like those found within SALA objects.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ClockPlot" class="doc_header"><code>class</code> <code>ClockPlot</code><a href="SALA/plots.py#L18" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ClockPlot</code>()</p>
</blockquote>
<p>Clock-style plots for groupings within timing data. Requires specific information
about light and location in order to properly render all portions of the plot. This
information can be properly appended to a dataframe through the usage of the main
SALA module.</p>

<pre><code>Methods
-------
mins_to_radians(data)
    Maps a series of minutes to radians for plot making.
print_time(mins)
    Takes in a time as a float and returns a printable format.
plot(timing_data, group_by, thresholds=[], figsize=(5,10), timezone=None)
    Creates a clock-shaped plot for grouping with SALA-styled timing data.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="ClockPlot.plot" class="doc_header"><code>ClockPlot.plot</code><a href="SALA/plots.py#L76" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>ClockPlot.plot</code>(<strong><code>timing_data</code></strong>, <strong><code>group_by</code></strong>, <strong><code>thresholds</code></strong>=<em><code>[]</code></em>, <strong><code>figsize</code></strong>=<em><code>(5, 10)</code></em>, <strong><code>timezone</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Creates clock plots for a grouping within SALA-styled timing data. For
full functionality, the data should have specifically labeled columns for
'Sunrise', 'Sunset', 'Mins to FL from 4AM', 'Mins to LL from 4AM', 'Sleep offset MSLM',
'Sleep onset MSLM', and 'Threshold'.</p>
<h4 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h4>
<pre><code>timing_data: pd.DataFrame or SALA
    Timing data stored within a pandas dataframe, or a SALA object with
    properly initialized data stored.

group_by: str
    String to group the data by for comparison. (e.g. comparing Weekends/Holidays
    against business days).

thresholds: list
    List of light thresholds to draw.

figsize: tuple
    Desired size of the outputted figure.

timezone: str
    Timezone of the provided data. This should be of a single timezone. List
    of valid timezones can be found in pytz.timezones.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creating-Clock-Plots">Creating Clock Plots<a class="anchor-link" href="#Creating-Clock-Plots"> </a></h2><p>One of the major plot types provided by SALA is a clock-style plot, meant to track aggregated light lux and sleep information for participants over the course of a day.</p>
<p>To appropriately generate clock plots, the data should be represented in a dataframe that at minimum has the following columns listed below. These columns are naturally found in SALA style objects, though plot generation does not specifically require a SALA object.</p>
<ol>
<li>'Sunrise'</li>
<li>'Sunset'</li>
<li>'Mins to FL from 4AM'  (FL = First Light)</li>
<li>'Mins to LL from 4AM'  (LL = Last Light)</li>
<li>'Sleep offset MSLM' (MSLM = Minutes from Last Midnight)</li>
<li>'Sleep onset MSLM'</li>
<li>'Threshold'</li>
<li>A categorical grouping within the data</li>
</ol>
<p>These columns are responsible for core figure elements such as the distinction between night and day, as well as the range values for the lux thresholds displayed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Clock plots generated adhere to a general format:</p>
<ul>
<li>One 'clock' is drawn for each of the specified categorical groupings. In this example, the data is either a 'Weekend/Holiday' or not, that is a boolean representation of if a data point belongs to a working day or a weekend/holiday. </li>
</ul>
<ul>
<li>Black and white are used to visually distinguish night from day by using timezone information to calculate the appropriate sunrise and sunset timings based on the days within the data. This requires the data to have a valid timezone. Plot generation requires specifying timezone information in order to mathematically convert the timing into a radian format. In cases where the data is lacking timezone information, it is localized to the provided timezone. A list of valid timezones can be found in pytz timezones. </li>
</ul>
<ul>
<li>The median sunrise and sunset times are used to distinguish night from day. Therefore <strong>it is crucial that all data entered into a clock plot comes from a similar time of year</strong> (e.g. weeks to months)</li>
</ul>
<ul>
<li>A range (IQR) of onset and offset for each of the thresholds specified is plotted. These thresholds should be present in the 'Threshold' column of the inputted data. A black bar representing the median of each of these thresholds is also created. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The sample figures generated below follow the same example data used in the core SALA module. For more information on how this data is generated, please visit the main module.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">file_prefix</span> <span class="o">=</span> <span class="s2">&quot;example_output/&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">file_prefix</span><span class="o">+</span><span class="s1">&#39;timing.parquet&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;fastparquet&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>UID</th>
      <th>Date</th>
      <th>Threshold</th>
      <th>Last Light</th>
      <th>Mins to LL from 4AM</th>
      <th>First Light</th>
      <th>Mins to FL from 4AM</th>
      <th>Time above threshold</th>
      <th>Time above threshold AM</th>
      <th>Minutes above threshold</th>
      <th>...</th>
      <th>GroupDayofWeek</th>
      <th>GroupDayType</th>
      <th>Weekend/Holiday</th>
      <th>Sunrise</th>
      <th>Sunset</th>
      <th>Sleep onset</th>
      <th>Sleep offset</th>
      <th>Sleep duration</th>
      <th>Sleep onset MSLM</th>
      <th>Sleep offset MSLM</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>base_v1\user1234</td>
      <td>2018-07-06</td>
      <td>5</td>
      <td>2018-07-06 23:24:00</td>
      <td>1164.0</td>
      <td>2018-07-06 06:44:30</td>
      <td>164.0</td>
      <td>0 days 09:38:30</td>
      <td>0 days 05:00:00</td>
      <td>578.5</td>
      <td>...</td>
      <td>base_Fri</td>
      <td>base_Weekday</td>
      <td>False</td>
      <td>2018-07-06 05:46:51.515407-07:00</td>
      <td>2018-07-06 20:00:28.277904-07:00</td>
      <td>2018-07-07 00:08:00</td>
      <td>2018-07-07 06:53:30</td>
      <td>0 days 06:45:30</td>
      <td>1448.0</td>
      <td>413.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>base_v1\user1234</td>
      <td>2018-06-26</td>
      <td>5</td>
      <td>2018-06-26 23:46:00</td>
      <td>1186.0</td>
      <td>2018-06-26 07:01:30</td>
      <td>181.0</td>
      <td>0 days 10:22:30</td>
      <td>0 days 04:15:00</td>
      <td>622.5</td>
      <td>...</td>
      <td>base_Tues</td>
      <td>base_Weekday</td>
      <td>False</td>
      <td>2018-06-26 05:42:43.671604-07:00</td>
      <td>2018-06-26 20:00:56.207091-07:00</td>
      <td>2018-06-27 00:04:30</td>
      <td>2018-06-27 09:12:00</td>
      <td>0 days 09:07:30</td>
      <td>1444.5</td>
      <td>552.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>base_v1\user1234</td>
      <td>2018-07-03</td>
      <td>5</td>
      <td>2018-07-03 23:31:00</td>
      <td>1171.0</td>
      <td>2018-07-03 07:00:30</td>
      <td>180.0</td>
      <td>0 days 12:47:30</td>
      <td>0 days 03:37:30</td>
      <td>767.5</td>
      <td>...</td>
      <td>base_Tues</td>
      <td>base_Weekday</td>
      <td>False</td>
      <td>2018-07-03 05:45:26.661576-07:00</td>
      <td>2018-07-03 20:00:52.991415-07:00</td>
      <td>2018-07-03 23:57:30</td>
      <td>2018-07-04 06:14:00</td>
      <td>0 days 06:16:30</td>
      <td>1437.5</td>
      <td>374.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>base_v1\user1234</td>
      <td>2018-06-29</td>
      <td>5</td>
      <td>2018-06-29 22:18:30</td>
      <td>1098.0</td>
      <td>2018-06-29 06:47:00</td>
      <td>167.0</td>
      <td>0 days 05:00:30</td>
      <td>0 days 03:26:30</td>
      <td>300.5</td>
      <td>...</td>
      <td>base_Fri</td>
      <td>base_Weekday</td>
      <td>False</td>
      <td>2018-06-29 05:43:47.073555-07:00</td>
      <td>2018-06-29 20:01:04.028805-07:00</td>
      <td>2018-06-29 22:20:00</td>
      <td>2018-06-30 07:44:00</td>
      <td>0 days 09:24:00</td>
      <td>1340.0</td>
      <td>464.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>base_v1\user1234</td>
      <td>2018-07-05</td>
      <td>5</td>
      <td>2018-07-05 23:20:30</td>
      <td>1160.0</td>
      <td>2018-07-05 06:40:00</td>
      <td>160.0</td>
      <td>0 days 10:52:30</td>
      <td>0 days 04:00:30</td>
      <td>652.5</td>
      <td>...</td>
      <td>base_Thu</td>
      <td>base_Weekday</td>
      <td>False</td>
      <td>2018-07-05 05:46:22.329317-07:00</td>
      <td>2018-07-05 20:00:38.094219-07:00</td>
      <td>2018-07-05 23:27:00</td>
      <td>2018-07-06 06:29:00</td>
      <td>0 days 07:02:00</td>
      <td>1407.0</td>
      <td>389.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>29</th>
      <td>follow_up_v3\user1234</td>
      <td>2018-09-23</td>
      <td>1000</td>
      <td>2018-09-23 17:05:30</td>
      <td>785.0</td>
      <td>2018-09-23 06:45:30</td>
      <td>165.0</td>
      <td>0 days 01:40:30</td>
      <td>0 days 00:51:30</td>
      <td>100.5</td>
      <td>...</td>
      <td>follow_up_Sun</td>
      <td>follow_up_Weekend/Holiday</td>
      <td>True</td>
      <td>2018-09-23 06:38:03.222580-07:00</td>
      <td>2018-09-23 18:43:54.008700-07:00</td>
      <td>2018-09-23 23:30:00</td>
      <td>2018-09-24 05:46:30</td>
      <td>0 days 06:16:30</td>
      <td>1410.0</td>
      <td>346.5</td>
    </tr>
    <tr>
      <th>30</th>
      <td>follow_up_v3\user1234</td>
      <td>2018-10-01</td>
      <td>1000</td>
      <td>2018-10-01 08:27:30</td>
      <td>267.0</td>
      <td>2018-10-01 07:42:00</td>
      <td>222.0</td>
      <td>0 days 00:05:00</td>
      <td>0 days 00:05:00</td>
      <td>5.0</td>
      <td>...</td>
      <td>follow_up_Mon</td>
      <td>follow_up_Weekday</td>
      <td>False</td>
      <td>2018-10-01 06:43:23.553420-07:00</td>
      <td>2018-10-01 18:33:09.795965-07:00</td>
      <td>2018-10-01 00:00:00</td>
      <td>2018-10-01 00:00:00</td>
      <td>0 days 00:00:00</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>31</th>
      <td>follow_up_v3\user1234</td>
      <td>2018-09-21</td>
      <td>1000</td>
      <td>2018-09-21 20:06:00</td>
      <td>966.0</td>
      <td>2018-09-21 07:07:00</td>
      <td>187.0</td>
      <td>0 days 02:23:00</td>
      <td>0 days 00:27:00</td>
      <td>143.0</td>
      <td>...</td>
      <td>follow_up_Fri</td>
      <td>follow_up_Weekday</td>
      <td>False</td>
      <td>2018-09-21 06:36:44.751023-07:00</td>
      <td>2018-09-21 18:46:36.832014-07:00</td>
      <td>2018-09-21 22:18:30</td>
      <td>2018-09-22 06:17:30</td>
      <td>0 days 07:59:00</td>
      <td>1338.5</td>
      <td>377.5</td>
    </tr>
    <tr>
      <th>32</th>
      <td>follow_up_v3\user1234</td>
      <td>2018-09-22</td>
      <td>1000</td>
      <td>2018-09-22 23:05:30</td>
      <td>1145.0</td>
      <td>2018-09-22 07:07:00</td>
      <td>187.0</td>
      <td>0 days 04:24:30</td>
      <td>0 days 01:59:30</td>
      <td>264.5</td>
      <td>...</td>
      <td>follow_up_Sat</td>
      <td>follow_up_Weekend/Holiday</td>
      <td>True</td>
      <td>2018-09-22 06:37:23.924753-07:00</td>
      <td>2018-09-22 18:45:15.374395-07:00</td>
      <td>2018-09-22 22:11:00</td>
      <td>2018-09-23 05:51:00</td>
      <td>0 days 07:40:00</td>
      <td>1331.0</td>
      <td>351.0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>follow_up_v3\user1234</td>
      <td>2018-09-24</td>
      <td>1000</td>
      <td>2018-09-24 16:57:30</td>
      <td>777.0</td>
      <td>2018-09-24 12:08:00</td>
      <td>488.0</td>
      <td>0 days 01:03:00</td>
      <td>0 days 00:00:00</td>
      <td>63.0</td>
      <td>...</td>
      <td>follow_up_Mon</td>
      <td>follow_up_Weekday</td>
      <td>False</td>
      <td>2018-09-24 06:38:42.656814-07:00</td>
      <td>2018-09-24 18:42:32.763067-07:00</td>
      <td>2018-09-24 21:31:00</td>
      <td>2018-09-25 04:44:30</td>
      <td>0 days 07:13:30</td>
      <td>1291.0</td>
      <td>284.5</td>
    </tr>
  </tbody>
</table>
<p>204 rows × 26 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below is a representation of the data formats of the columns necessary for clock plot creation.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Mins to LL from 4AM&quot;</span><span class="p">,</span> <span class="s2">&quot;Mins to FL from 4AM&quot;</span><span class="p">,</span>
     <span class="s2">&quot;Sunrise&quot;</span><span class="p">,</span> <span class="s2">&quot;Sunset&quot;</span><span class="p">,</span> <span class="s2">&quot;Sleep onset&quot;</span><span class="p">,</span> <span class="s2">&quot;Sleep offset&quot;</span><span class="p">,</span>
     <span class="s2">&quot;Sleep duration&quot;</span><span class="p">,</span> <span class="s2">&quot;Sleep onset MSLM&quot;</span><span class="p">,</span>
     <span class="s2">&quot;Sleep offset MSLM&quot;</span><span class="p">]</span>
    <span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Mins to LL from 4AM</th>
      <th>Mins to FL from 4AM</th>
      <th>Sunrise</th>
      <th>Sunset</th>
      <th>Sleep onset</th>
      <th>Sleep offset</th>
      <th>Sleep duration</th>
      <th>Sleep onset MSLM</th>
      <th>Sleep offset MSLM</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1164.0</td>
      <td>164.0</td>
      <td>2018-07-06 05:46:51.515407-07:00</td>
      <td>2018-07-06 20:00:28.277904-07:00</td>
      <td>2018-07-07 00:08:00</td>
      <td>2018-07-07 06:53:30</td>
      <td>0 days 06:45:30</td>
      <td>1448.0</td>
      <td>413.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1186.0</td>
      <td>181.0</td>
      <td>2018-06-26 05:42:43.671604-07:00</td>
      <td>2018-06-26 20:00:56.207091-07:00</td>
      <td>2018-06-27 00:04:30</td>
      <td>2018-06-27 09:12:00</td>
      <td>0 days 09:07:30</td>
      <td>1444.5</td>
      <td>552.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1171.0</td>
      <td>180.0</td>
      <td>2018-07-03 05:45:26.661576-07:00</td>
      <td>2018-07-03 20:00:52.991415-07:00</td>
      <td>2018-07-03 23:57:30</td>
      <td>2018-07-04 06:14:00</td>
      <td>0 days 06:16:30</td>
      <td>1437.5</td>
      <td>374.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1098.0</td>
      <td>167.0</td>
      <td>2018-06-29 05:43:47.073555-07:00</td>
      <td>2018-06-29 20:01:04.028805-07:00</td>
      <td>2018-06-29 22:20:00</td>
      <td>2018-06-30 07:44:00</td>
      <td>0 days 09:24:00</td>
      <td>1340.0</td>
      <td>464.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1160.0</td>
      <td>160.0</td>
      <td>2018-07-05 05:46:22.329317-07:00</td>
      <td>2018-07-05 20:00:38.094219-07:00</td>
      <td>2018-07-05 23:27:00</td>
      <td>2018-07-06 06:29:00</td>
      <td>0 days 07:02:00</td>
      <td>1407.0</td>
      <td>389.0</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ClockPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
               <span class="s1">&#39;Weekend/Holiday&#39;</span><span class="p">,</span>
               <span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
               <span class="n">timezone</span> <span class="o">=</span> <span class="s1">&#39;America/Los_Angeles&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LightPlot" class="doc_header"><code>class</code> <code>LightPlot</code><a href="SALA/plots.py#L274" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LightPlot</code>()</p>
</blockquote>
<p>Creates various light plots for grouped data based on time of day.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="LightPlot.plot" class="doc_header"><code>LightPlot.plot</code><a href="SALA/plots.py#L277" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>LightPlot.plot</code>(<strong><code>data_list</code></strong>, <strong><code>labels</code></strong>, <strong><code>palette</code></strong>=<em><code>'deep'</code></em>, <strong><code>plot_type</code></strong>=<em><code>'mean/sem'</code></em>, <strong><code>y_lim</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Generates light plots.</p>
<h4 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h4><p>data_list: list</p>

<pre><code>A list of series of light data for plotting.
</code></pre>
<p>labels: list</p>

<pre><code>A list of labels corresponding how you'd like each series in d_list to be labeled.
</code></pre>
<p>palette: string</p>

<pre><code>Valid seaborn color palette title.
</code></pre>
<p>plot_type: str</p>

<pre><code>The type of plot you'd like to create. Default is "mean/sem". Other choices are
"counts", and "quantiles"
</code></pre>
<p>y_limit: int or None</p>

<pre><code>Desired default range for y_limit of the outputted plots.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creating-Light-Plots">Creating Light Plots<a class="anchor-link" href="#Creating-Light-Plots"> </a></h2><p>The other core plot type for SALA are specialized light plots. The y-axis size can be controlled for mean/sem plots or quantile plots. There are three available light plot styles:</p>
<ul>
<li>"mean/sem"</li>
</ul>
<p>Plots the mean and standard error for light measurement across a day.</p>
<ul>
<li>counts</li>
</ul>
<p>Plots the counts for light measurement across a day.</p>
<ul>
<li>quantiles</li>
</ul>
<p>Plots quantiles of light measurement across a day.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the following example analysis, we'll take the same example data used for the main SALA module and plot data that exists under the following conditions by grouping times to the nearest
quarter-hour:</p>
<ol>
<li><p>The watch must be On-Wrist</p>
</li>
<li><p>The interval status must be either 'ACTIVE' or 'REST'</p>
</li>
<li><p>The White Light reading must be at least 1.0. Lower light readings tend to be less accurate, and potentially noisy.</p>
</li>
</ol>
<p>Any quarter-hours with under 50 valid light readings are ommitted.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">quarter_hourly</span><span class="p">(</span><span class="n">dtime</span><span class="p">):</span>
    <span class="n">tm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">:</span><span class="si">{:02d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtime</span><span class="o">.</span><span class="n">hour</span><span class="p">,(</span><span class="n">dtime</span><span class="o">.</span><span class="n">minute</span><span class="o">//</span><span class="mi">15</span><span class="p">)</span><span class="o">*</span><span class="mi">15</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">file_prefix</span><span class="o">+</span><span class="s1">&#39;raw.parquet&#39;</span><span class="p">)</span>
<span class="n">these_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;Off-Wrist Status&#39;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span> <span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;Interval Status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;ACTIVE&#39;</span><span class="p">,</span><span class="s1">&#39;REST&#39;</span><span class="p">]),</span> <span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;White Light&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">)</span> 
<span class="k">for</span> <span class="n">agroup</span> <span class="ow">in</span> <span class="n">all_data</span><span class="o">.</span><span class="n">Group</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">agroup</span><span class="p">)</span>
    <span class="n">theones</span> <span class="o">=</span> <span class="p">(</span><span class="n">all_data</span><span class="o">.</span><span class="n">Group</span> <span class="o">==</span> <span class="n">agroup</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">these_rows</span><span class="p">)</span>
    <span class="n">exec</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> = all_data[theones].dropna().groupby(quarter_hourly).filter(lambda x: x[&quot;White Light&quot;].count()&gt;50,dropna=False).groupby(quarter_hourly)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">agroup</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">),</span>  <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By going through the raw data, we've generated two dataframes for light that can be compared.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This first example plot compares mean white light from the existing raw data by separating it based on the corresponding visit (base or follow up). The shadows drawn are corresponding standard error measurements.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LightPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">base_</span><span class="p">[</span><span class="s2">&quot;White Light&quot;</span><span class="p">],</span>
                <span class="n">follow_up_</span><span class="p">[</span><span class="s2">&quot;White Light&quot;</span><span class="p">]],</span>
               <span class="p">[</span><span class="s2">&quot;base_&quot;</span><span class="p">,</span> <span class="s2">&quot;follow_up_&quot;</span><span class="p">],</span>
              <span class="n">y_lim</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This second example plot compares the mean number of samples across the day for each of the visit types.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LightPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">base_</span><span class="p">[</span><span class="s2">&quot;White Light&quot;</span><span class="p">],</span>
                <span class="n">follow_up_</span><span class="p">[</span><span class="s2">&quot;White Light&quot;</span><span class="p">]],</span>
               <span class="p">[</span><span class="s2">&quot;base_&quot;</span><span class="p">,</span> <span class="s2">&quot;follow_up_&quot;</span><span class="p">],</span>
               <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;counts&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final plot shows quantiles of light compared for the two visit types.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LightPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">base_</span><span class="p">[</span><span class="s2">&quot;White Light&quot;</span><span class="p">],</span>
                <span class="n">follow_up_</span><span class="p">[</span><span class="s2">&quot;White Light&quot;</span><span class="p">]],</span>
               <span class="p">[</span><span class="s2">&quot;base_&quot;</span><span class="p">,</span> <span class="s2">&quot;follow_up_&quot;</span><span class="p">],</span>
               <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span> <span class="n">y_lim</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>


