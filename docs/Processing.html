---

title: Processing


keywords: fastai
sidebar: home_sidebar

summary: "Core module of SALA, built to process actiwatch data for a single individual. Prepares actiwatch style data exported in a CSV from Philips Actiware watches and produces additional analyses."
description: "Core module of SALA, built to process actiwatch data for a single individual. Prepares actiwatch style data exported in a CSV from Philips Actiware watches and produces additional analyses."
nb_path: "00_Processing.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_Processing.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SALAFrame" class="doc_header"><code>class</code> <code>SALAFrame</code><a href="https://github.com/tktran11/SALA/tree/master/SALA/SALA/processing.py#L6" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SALAFrame</code>(<strong><code>latitude</code></strong>, <strong><code>longitude</code></strong>, <strong><code>timezone</code></strong>, <strong><code>data</code></strong>=<em><code>None</code></em>, <strong><code>directory</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>DataFrame-like storage for actiwatch data loaded either from a directory of csv files
or an existing SALA or dataframe object.</p>

<pre><code>Attributes
----------
data: pd.DataFrame or None
    Initialized as None, but can be set as a dataframe, which is expected to contain
    light and sleep information consistent with SALA formatting. It should only be
    pre-set to an existing dataframe when trying to migrate existing data to a SALA
    object.

directory: dictionary or None
    Dictionary style pairing of grouping names serving as keys (e.g. baseline,
    intervention), with corresponding values as relative file paths storing csv
    files to be read as data.

timezone: str
    Single timezone specified for all data within the object. A list of
    valid timezones can be obtained from pytz.all_timezones. Note that it is impossible
    for different timezones to be present (all data must be converted to a single timezone)

latitude: float
    Latitude position for sunrise/sunset calculations.

longitude: float
    Longitude position for sunrise/sunset calculations.

Methods
-------
init(data=None, directory=None, timezone=None, latitude=None, longitude=None)
    Initialization with a pre-processed SALA-eqsue dataframe or raw data and file details
    for loading and processing data.

get_raw_data_from_key(key, directory, grouping='Group')
    Loads and combines all raw data from multiple csv files within a specified file source
    based on a given key. Key indicates a grouping of multiple csvs.

get_raw_data(directory, grouping='Group')
    Loads and combines all raw data from multiple csv files for all keys within
    a directory for a given directory of file sources.

export(data)
    Exports the data within a SALA object to a parquet file format.

process_data(raw_data, thresholds)
    Handles unprocessed combined raw data outputting first and last light times,
    and group identifiers for all specified light thresholds.

sun_timings()
    Calculates sunset and sunrise timing information for currently stored SALA
    data, based on the timezone info within the stored data.

do_everything()
    TO ADD AFTER TESTING OTHER NEW FUNCTIONS.

process_sleep_data
    Processes sleep data for existing timing data, generating a summary dataframe
    based on the number of sleep periods within the data.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creating-SALA-Objects">Creating SALA Objects<a class="anchor-link" href="#Creating-SALA-Objects"> </a></h2><p>SALA objects can be created by using the initialization method provided. This method requires location specific information and either existing data or a data source directory:</p>
<h4 id="Latitude,-Longitude,-Timezone">Latitude, Longitude, Timezone<a class="anchor-link" href="#Latitude,-Longitude,-Timezone"> </a></h4><p>These location specific information pieces are necessary in generating accurate sunrise and sunset timings.</p>
<h4 id="Data">Data<a class="anchor-link" href="#Data"> </a></h4><p>This should consist of a processed dataframe in SALA-style, with corresponding columns such as 
"First Light", "Date", "Lux Minutes", etc. Data should be entered as a variable in cases where existing data missing sunrise or sunset data is available or for immediate use with SALA-style plots.</p>
<h4 id="Directory">Directory<a class="anchor-link" href="#Directory"> </a></h4><p>In most cases, it is preferred to have a directory entered. A directory should be in dictionary style, where keys denote file groupings (e.g. baseline versus intervention) and the values denote relative file paths/folders to find csv stored data in.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="SALAFrame.__init__" class="doc_header"><code>SALAFrame.__init__</code><a href="https://github.com/tktran11/SALA/tree/master/SALA/SALA/processing.py#L69" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>SALAFrame.__init__</code>(<strong><code>latitude</code></strong>, <strong><code>longitude</code></strong>, <strong><code>timezone</code></strong>, <strong><code>data</code></strong>=<em><code>None</code></em>, <strong><code>directory</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Initializes a SALA object either from existing parsed timing data, or from a directory
of csvs. Timezone information can be optionally included to allow for sunset, sunrise
data to be added.</p>
<h4 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h4>
<pre><code>timezone: str
    A valid timezone (a list of timezones can be obtained from pytz.all_timezones).

latitude: float
    Latitude position for sunrise/sunset calculations. Northern latitudes
    should be positive values.

longitude: float
    Longitude position for sunrise/sunset calculations. Eastern longitudes
    should be positive values.

data: pd.DataFrame (optional)
    If not None, data should be a pre-processed SALA-format dataframe, expected to contain
    details on light and sleep information.

directory: dictionary (optional)
    Dictionary of valid folder names to load actiwatch data from.
    Folders should have .csv files in them.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>SALA objects can be initialized in one of two methods.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">directory</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;base_&#39;</span><span class="p">:</span> <span class="s1">&#39;data/v1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;follow_up_&#39;</span><span class="p">:</span> <span class="s1">&#39;data/v3&#39;</span>
<span class="p">}</span>
<span class="n">timezone</span> <span class="o">=</span> <span class="s2">&quot;America/Los_Angeles&quot;</span>
<span class="n">latitude</span> <span class="o">=</span> <span class="mf">47.65</span>
<span class="n">longitude</span> <span class="o">=</span> <span class="o">-</span><span class="mf">122.30</span>

<span class="n">sala_from_directory</span> <span class="o">=</span> <span class="n">SALAFrame</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">timezone</span><span class="p">,</span> <span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;example_output/timing.parquet&quot;</span><span class="p">)</span>
<span class="n">sala_from_data</span> <span class="o">=</span> <span class="n">SALAFrame</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">timezone</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loading-Actiwatch-Data-and-Raw-Data-Manipulation">Loading Actiwatch Data and Raw Data Manipulation<a class="anchor-link" href="#Loading-Actiwatch-Data-and-Raw-Data-Manipulation"> </a></h2><p>Actiwatch data should be loaded in a directory-style setup with key value pairings. This is intended to provide a generally flexible method for group labeling within the data for easier grouped searching and analysis.</p>
<h4 id="Keys">Keys<a class="anchor-link" href="#Keys"> </a></h4><p>Keys should be indicative of the group name and are used in generating UIDs. The in-documentation example below uses base_ and follow<em>up</em> as its keys.</p>
<h4 id="Values">Values<a class="anchor-link" href="#Values"> </a></h4><p>Corresponding Values should be relative file paths to find csv data to be loaded for a respective group. The example data uses csvs within two folders "data/v1" and "data/v3" which correspond to the keys "base_" and "follow<em>up</em>" respectively. Note that the trailing part of the folder path (after the final /) is appended to the UID. The remaining part of the UID is build using the filename within the subfolder.</p>
<p>Following this structure, an example file titled "user1234" in "data/v1" would generate a UID of "base_v1\user1234".</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="SALAFrame.get_raw_data_from_key" class="doc_header"><code>SALAFrame.get_raw_data_from_key</code><a href="https://github.com/tktran11/SALA/tree/master/SALA/SALA/processing.py#L162" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>SALAFrame.get_raw_data_from_key</code>(<strong><code>key</code></strong>, <strong><code>directory</code></strong>=<em><code>None</code></em>, <strong><code>grouping</code></strong>=<em><code>'Group'</code></em>)</p>
</blockquote>
<p>Loads and combines raw actiwatch data from any csv files found in
the specified directory matching a particular key within the directory.</p>
<h4 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h4><p>key: str</p>

<pre><code> The key to load actiwatch data from (for example, "v1").

</code></pre>
<p>directory: dict</p>

<pre><code> Dictionary of valid folders to load actiwatch data from.
 Folders should have .csv files in them. If no dictionary
 is provided, it uses the one initialized as part of the SALA
 object.

</code></pre>
<p>grouping: str</p>

<pre><code> Name of the generated column for specifying groupings, where
 the values will be the name of the key given. Default = 'Group'.

</code></pre>
<h4 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h4><p>All of the raw unprocessed data within the directory matching a specified key.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Loading-Data-for-a-Single-Key">Loading Data for a Single Key<a class="anchor-link" href="#Loading-Data-for-a-Single-Key"> </a></h3><p>Raw data for a particular key within the directory can be gathered by giving this function a key and a directory to load data from. If no directory is given, the function will automatically use the directory specified when creating a SALA object.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_data</span> <span class="o">=</span> <span class="n">sala</span><span class="o">.</span><span class="n">get_raw_data_from_key</span><span class="p">(</span><span class="s2">&quot;base_&quot;</span><span class="p">)</span>
<span class="n">raw_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Found 1 csv files in data/v1/. Pass #1, raw data
.
.
Pass #2, data summary
.
.EOF without retrieving summary data: data/v1\user1234_v1sample.csv
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Off-Wrist Status</th>
      <th>Activity</th>
      <th>Marker</th>
      <th>White Light</th>
      <th>Red Light</th>
      <th>Green Light</th>
      <th>Blue Light</th>
      <th>Sleep/Wake</th>
      <th>Interval Status</th>
      <th>UID</th>
      <th>Group</th>
    </tr>
    <tr>
      <th>DateTime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-06-25 12:31:00</th>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>37.09</td>
      <td>28.4</td>
      <td>15.5</td>
      <td>14.5</td>
      <td>1.0</td>
      <td>ACTIVE</td>
      <td>base_v1\user1234</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>2018-06-25 12:31:30</th>
      <td>0</td>
      <td>170.0</td>
      <td>0.0</td>
      <td>156.15</td>
      <td>159.0</td>
      <td>59.9</td>
      <td>65.3</td>
      <td>1.0</td>
      <td>ACTIVE</td>
      <td>base_v1\user1234</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>2018-06-25 12:32:00</th>
      <td>0</td>
      <td>194.0</td>
      <td>0.0</td>
      <td>149.03</td>
      <td>113.0</td>
      <td>49.8</td>
      <td>50.6</td>
      <td>1.0</td>
      <td>ACTIVE</td>
      <td>base_v1\user1234</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>2018-06-25 12:32:30</th>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>473.95</td>
      <td>365.0</td>
      <td>161.0</td>
      <td>161.0</td>
      <td>1.0</td>
      <td>ACTIVE</td>
      <td>base_v1\user1234</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>2018-06-25 12:33:00</th>
      <td>0</td>
      <td>62.0</td>
      <td>0.0</td>
      <td>317.82</td>
      <td>264.0</td>
      <td>112.0</td>
      <td>115.0</td>
      <td>1.0</td>
      <td>ACTIVE</td>
      <td>base_v1\user1234</td>
      <td>base_</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="SALAFrame.get_raw_data" class="doc_header"><code>SALAFrame.get_raw_data</code><a href="https://github.com/tktran11/SALA/tree/master/SALA/SALA/processing.py#L197" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>SALAFrame.get_raw_data</code>(<strong><code>outfile</code></strong>, <strong><code>directory</code></strong>=<em><code>None</code></em>, <strong><code>grouping</code></strong>=<em><code>'Group'</code></em>, <strong><code>export</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Loads and combines raw actiwatch data from any csv files found in
the specified directory for all keys within the directory.</p>
<h4 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h4><p>outfile: str</p>

<pre><code> Directory to save to. (e.g. ../SALA/example_output/)

</code></pre>
<p>directory: dict</p>

<pre><code> Dictionary of valid folders to load actiwatch data from.
 Folders should have .csv files in them. If no dictionary
 is provided, it uses the one initialized as part of the SALA
 object.

</code></pre>
<p>grouping: str</p>

<pre><code> Name of the generated column for specifying groupings, where
 the values will be the name of the key given. Default = 'Group'.

</code></pre>
<p>export: bool</p>

<pre><code> Whether or not to export combined raw data to a parquet file saved in the designated
 outfile location.

</code></pre>
<h4 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h4><p>All of the raw unprocessed data within the directory for all keys as a single
 dataframe.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Loading-Data-for-All-Keys">Loading Data for All Keys<a class="anchor-link" href="#Loading-Data-for-All-Keys"> </a></h3><p>Raw data for all keys can similarly be loaded by providing an outfile to save the generated file to. Saving is controlled via a boolean command. A directory to load data from is also necessary. If no directory is given, the function will automatically use the directory specified when creating a SALA object.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outfile</span> <span class="o">=</span> <span class="s2">&quot;../SALA/example_output/&quot;</span>
<span class="n">all_raw_data</span> <span class="o">=</span> <span class="n">sala</span><span class="o">.</span><span class="n">get_raw_data</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">all_raw_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Off-Wrist Status</th>
      <th>Activity</th>
      <th>Marker</th>
      <th>White Light</th>
      <th>Red Light</th>
      <th>Green Light</th>
      <th>Blue Light</th>
      <th>Sleep/Wake</th>
      <th>Interval Status</th>
      <th>UID</th>
      <th>Group</th>
    </tr>
    <tr>
      <th>DateTime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-06-25 12:31:00</th>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>37.09</td>
      <td>28.4</td>
      <td>15.5</td>
      <td>14.5</td>
      <td>1.0</td>
      <td>ACTIVE</td>
      <td>base_v1\user1234</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>2018-06-25 12:31:30</th>
      <td>0</td>
      <td>170.0</td>
      <td>0.0</td>
      <td>156.15</td>
      <td>159.0</td>
      <td>59.9</td>
      <td>65.3</td>
      <td>1.0</td>
      <td>ACTIVE</td>
      <td>base_v1\user1234</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>2018-06-25 12:32:00</th>
      <td>0</td>
      <td>194.0</td>
      <td>0.0</td>
      <td>149.03</td>
      <td>113.0</td>
      <td>49.8</td>
      <td>50.6</td>
      <td>1.0</td>
      <td>ACTIVE</td>
      <td>base_v1\user1234</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>2018-06-25 12:32:30</th>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>473.95</td>
      <td>365.0</td>
      <td>161.0</td>
      <td>161.0</td>
      <td>1.0</td>
      <td>ACTIVE</td>
      <td>base_v1\user1234</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>2018-06-25 12:33:00</th>
      <td>0</td>
      <td>62.0</td>
      <td>0.0</td>
      <td>317.82</td>
      <td>264.0</td>
      <td>112.0</td>
      <td>115.0</td>
      <td>1.0</td>
      <td>ACTIVE</td>
      <td>base_v1\user1234</td>
      <td>base_</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exporting-Data">Exporting Data<a class="anchor-link" href="#Exporting-Data"> </a></h2><p>SALA provides its own export function for taking existing SALA data and saving it to a parquet file. To save existing SALA data an outfile location must be provided. By default SALA exports the data stored within the object.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="SALAFrame.export" class="doc_header"><code>SALAFrame.export</code><a href="https://github.com/tktran11/SALA/tree/master/SALA/SALA/processing.py#L246" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>SALAFrame.export</code>(<strong><code>outfile</code></strong>, <strong><code>data</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Exports existing timing data to a parquet format.</p>
<h4 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h4>
<pre><code>outfile: str

    Directory to save to. (e.g. ../SALA/example_output/)
data: pd.DataFrame

Desired dataframe for exporting.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processing-Data">Processing Data<a class="anchor-link" href="#Processing-Data"> </a></h2><p>The main functionality of SALA's is data processing. SALA's processing functions handle unprocessed combined raw data to outputt first and last light times, and group identifiers for specified light thresholds. SALA also supports adding sunrise and sunset data based on latitude and longitude.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="SALAFrame.process_data" class="doc_header"><code>SALAFrame.process_data</code><a href="https://github.com/tktran11/SALA/tree/master/SALA/SALA/processing.py#L269" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>SALAFrame.process_data</code>(<strong><code>raw_data</code></strong>, <strong><code>thresholds</code></strong>)</p>
</blockquote>
<p>Handles unprocessed combined raw data outputting first and last light times,
    and group identifiers for all specified light thresholds.</p>
<h4 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h4><p>raw_data: pd.DataFrame</p>

<pre><code>Combined dataframe of all raw data from desired directory. This can be
accomplished by using the get_raw_data function within the SALA class.

</code></pre>
<p>thresholds: list</p>

<pre><code>List of light thresholds for the watch data.

</code></pre>
<h4 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h4>
<pre><code>Processed timing data in a dataframe format, with specific identifier columns based
on weekday and weekend/holiday groupings.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">thresholds</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="mi">1000</span><span class="p">]]</span> 
<span class="n">outfile</span> <span class="o">=</span> <span class="s2">&quot;../SALA/example_output/&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this stage, any extra processing functions can be directly applied to the data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_first_day" class="doc_header"><code>remove_first_day</code><a href="https://github.com/tktran11/SALA/tree/master/SALA/SALA/processing.py#L525" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_first_day</code>(<strong><code>data</code></strong>)</p>
</blockquote>
<p>An example function that removes data
from the first day of recording. Typically the first
day has no light data for these watches (represented
as 'NaT')</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_first_day</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An example function that removes data</span>
<span class="sd">    from the first day of recording. Typically the first</span>
<span class="sd">    day has no light data for these watches (represented</span>
<span class="sd">    as &#39;NaT&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Last Light&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnat</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span>
               <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sala</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">sala</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">all_raw_data</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">)</span>
<span class="n">sala</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">remove_first_day</span><span class="p">(</span><span class="n">sala</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sala</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>UID</th>
      <th>Date</th>
      <th>Threshold</th>
      <th>Last Light</th>
      <th>Mins to LL from 4AM</th>
      <th>First Light</th>
      <th>Mins to FL from 4AM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>base_v1\user1234</td>
      <td>2018-06-30</td>
      <td>5</td>
      <td>2018-06-30 22:22:00</td>
      <td>1102.0</td>
      <td>2018-06-30 07:56:30</td>
      <td>236.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>base_v1\user1234</td>
      <td>2018-07-03</td>
      <td>5</td>
      <td>2018-07-03 23:31:00</td>
      <td>1171.0</td>
      <td>2018-07-03 07:00:30</td>
      <td>180.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>base_v1\user1234</td>
      <td>2018-06-27</td>
      <td>5</td>
      <td>2018-06-27 22:57:00</td>
      <td>1137.0</td>
      <td>2018-06-27 09:12:30</td>
      <td>312.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>base_v1\user1234</td>
      <td>2018-07-07</td>
      <td>5</td>
      <td>2018-07-08 00:01:30</td>
      <td>1201.0</td>
      <td>2018-07-07 06:54:30</td>
      <td>174.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>base_v1\user1234</td>
      <td>2018-07-08</td>
      <td>5</td>
      <td>2018-07-08 20:45:30</td>
      <td>1005.0</td>
      <td>2018-07-08 06:45:00</td>
      <td>165.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sala</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">7</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time above threshold</th>
      <th>Time above threshold AM</th>
      <th>Minutes above threshold</th>
      <th>Minutes above threshold AM</th>
      <th>Lux minutes</th>
      <th>Lux minutes AM</th>
      <th>Group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0 days 10:04:00</td>
      <td>0 days 03:26:30</td>
      <td>604.0</td>
      <td>206.5</td>
      <td>779254.835</td>
      <td>473764.040</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0 days 12:47:30</td>
      <td>0 days 03:37:30</td>
      <td>767.5</td>
      <td>217.5</td>
      <td>377968.040</td>
      <td>143815.500</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0 days 10:25:00</td>
      <td>0 days 02:23:00</td>
      <td>625.0</td>
      <td>143.0</td>
      <td>640912.350</td>
      <td>247699.580</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0 days 11:45:30</td>
      <td>0 days 04:37:30</td>
      <td>705.5</td>
      <td>277.5</td>
      <td>814059.620</td>
      <td>355668.225</td>
      <td>base_</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0 days 11:46:30</td>
      <td>0 days 04:39:30</td>
      <td>706.5</td>
      <td>279.5</td>
      <td>478718.375</td>
      <td>154556.710</td>
      <td>base_</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sala</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">14</span><span class="p">:]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Watch period</th>
      <th>DayofWeek</th>
      <th>GroupDayofWeek</th>
      <th>GroupDayType</th>
      <th>Weekend/Holiday</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0 days 00:00:30</td>
      <td>5</td>
      <td>base_Sat</td>
      <td>base_Weekend/Holiday</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0 days 00:00:30</td>
      <td>1</td>
      <td>base_Tues</td>
      <td>base_Weekday</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0 days 00:00:30</td>
      <td>2</td>
      <td>base_Wed</td>
      <td>base_Weekday</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0 days 00:00:30</td>
      <td>5</td>
      <td>base_Sat</td>
      <td>base_Weekend/Holiday</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0 days 00:00:30</td>
      <td>6</td>
      <td>base_Sun</td>
      <td>base_Weekend/Holiday</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setting-Sunset-and-Sunrise">Setting Sunset and Sunrise<a class="anchor-link" href="#Setting-Sunset-and-Sunrise"> </a></h2><p>SALA provides the ability to add sunrise and sunset information to processed data. To do so, the specific location (longitude and latitude) is required. To get correct sunrise and sunset times relative to a specific location, a timezone is also required. These fields are necessary when creating a SALA object and do not specifically need to be re-entered when calling SALA's sun timing function.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="SALAFrame.sun_timings" class="doc_header"><code>SALAFrame.sun_timings</code><a href="https://github.com/tktran11/SALA/tree/master/SALA/SALA/processing.py#L324" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>SALAFrame.sun_timings</code>()</p>
</blockquote>
<p>Calculates sunrise and sunset timing information for data present in the
SALA object.</p>
<h4 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h4>
<pre><code>Modified timing data with sunrise and sunset calculations</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sala</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">sala</span><span class="o">.</span><span class="n">sun_timings</span><span class="p">()</span>
<span class="n">sala</span><span class="o">.</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Sunrise&quot;</span><span class="p">,</span> <span class="s2">&quot;Sunset&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sunrise</th>
      <th>Sunset</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018-06-30 05:15:10.009843-07:00</td>
      <td>2018-06-30 21:10:28.189308-07:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018-07-03 05:17:02.116743-07:00</td>
      <td>2018-07-03 21:09:39.386344-07:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018-06-27 05:13:37.265731-07:00</td>
      <td>2018-06-27 21:10:53.349244-07:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018-07-07 05:19:59.495724-07:00</td>
      <td>2018-07-07 21:07:57.880755-07:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2018-07-08 05:20:48.480661-07:00</td>
      <td>2018-07-08 21:07:26.089296-07:00</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Complete-Processing">Complete Processing<a class="anchor-link" href="#Complete-Processing"> </a></h2><p>SALA additionally has a do-it-all function that handles the entire process from loading data from a directory up to adding sunrise and sunset information. It additionally defaults to exporting the information. It requires an outfile for potential saving, and light thresholds to work with. If a directory is not provided, it will use the directory present within the SALA object that was provided upon object creation.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="SALAFrame.do_everything" class="doc_header"><code>SALAFrame.do_everything</code><a href="https://github.com/tktran11/SALA/tree/master/SALA/SALA/processing.py#L347" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>SALAFrame.do_everything</code>(<strong><code>outfile</code></strong>, <strong><code>thresholds</code></strong>, <strong><code>directory</code></strong>=<em><code>None</code></em>, <strong><code>grouping</code></strong>=<em><code>'Group'</code></em>, <strong><code>export</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Handles the full SALA pipeline (excluding sleep period analysis), from processing and combining raw data
to parsing and calculating processed data with sunrise and sunset information. First loads and compiles
all existing raw data for every key within the given directory. Then processes all raw data, calculating
additional information for all specified light thresholds. Also adds sunrise and sunset information.</p>
<h4 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h4><p>outfile: str</p>

<pre><code>    Directory to save to. (e.g. ../SALA/example_output/)

</code></pre>
<p>thresholds: list</p>

<pre><code>List of light thresholds for the watch data.

</code></pre>
<p>directory: dict</p>

<pre><code>Dictionary of valid folders to load actiwatch data from.
Folders should have .csv files in them. If no dictionary
is provided, it uses the one initialized as part of the SALA
object.

</code></pre>
<p>grouping: str</p>

<pre><code>Name of the generated column for specifying groupings, where
the values will be the name of the key given. Default = 'Group'.

</code></pre>
<p>export: bool</p>

<pre><code>Whether or not to export processed timing data to a parquet file saved in the designated
outfile location.

</code></pre>
<h4 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h4>
<pre><code>Processed timing data in a dataframe format, with specific identifier columns based
on weekday and weekend/holiday groupings, and included sunrise and sunset calculations.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">thresholds</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="mi">1000</span><span class="p">]]</span> 
<span class="n">outfile</span> <span class="o">=</span> <span class="s2">&quot;../SALA/example_output/&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">sala</span><span class="o">.</span><span class="n">do_everything</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Additional-Sleep-Information">Additional Sleep Information<a class="anchor-link" href="#Additional-Sleep-Information"> </a></h2><p>Adding sleep information to the processed data is also possible. The below function adds sleep data, allowing a "sleep day" to be split at a customizable time. The outputs of the function are:</p>
<ol>
<li><p>short_frame: 
 a separate dataframe meant to be a quick way of visually subsetting and viewing bi/polyphasic instances. 
 This frame defaults to storing occurances of at least 3 sleep periods within a "sleep day", but can be modified.</p>
</li>
<li><p>timing_data:
 modifies stored data to have sleep period information</p>
</li>
</ol>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="SALAFrame.process_sleep" class="doc_header"><code>SALAFrame.process_sleep</code><a href="https://github.com/tktran11/SALA/tree/master/SALA/SALA/processing.py#L398" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>SALAFrame.process_sleep</code>(<strong><code>raw_data</code></strong>, <strong><code>sleep_split</code></strong>=<em><code>'18:00'</code></em>, <strong><code>num_sleeps</code></strong>=<em><code>3</code></em>)</p>
</blockquote>
<p>Processes sleep data for existing timing data.</p>
<h4 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h4><p>raw_data: pd.DataFrame</p>

<pre><code>Combined dataframe of all raw data from desired directory. This can be
accomplished by using the get_raw_data function within the SALA class.

</code></pre>
<p>sleep_split: str</p>

<pre><code>Time to split the sleep day. Default is "18:00", which is 6:00PM.

</code></pre>
<p>num_sleeps: int</p>

<pre><code>Cutoff for number of sleeps to display in first resulting frame.
Default = 3, frame will store days with 3+ sleep instances

</code></pre>
<h4 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h4>
<pre><code>short_frame: pd.DataFrame

    Onset, offset, and duration for sleep periods on days with
    more than num_sleeps number of sleep periods

timing_data: pd.DataFrame

    Modified timing data with included sleep information</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">short_frame</span><span class="p">,</span> <span class="n">timing_data</span> <span class="o">=</span> <span class="n">sala</span><span class="o">.</span><span class="n">process_sleep</span><span class="p">(</span><span class="n">all_raw_data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">short_frame</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Sleep period</th>
      <th>Sleep onset</th>
      <th>Sleep offset</th>
      <th>Sleep duration</th>
    </tr>
    <tr>
      <th>UID</th>
      <th>DT</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">base_v1\user1234</th>
      <th>2018-06-28</th>
      <td>0</td>
      <td>2018-06-29 00:40:30</td>
      <td>2018-06-29 06:41:00</td>
      <td>0 days 06:00:30</td>
    </tr>
    <tr>
      <th>2018-06-28</th>
      <td>2</td>
      <td>2018-06-29 13:42:00</td>
      <td>2018-06-29 15:23:30</td>
      <td>0 days 01:41:30</td>
    </tr>
    <tr>
      <th>2018-06-28</th>
      <td>1</td>
      <td>2018-06-29 08:50:30</td>
      <td>2018-06-29 09:04:00</td>
      <td>0 days 00:13:30</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">follow_up_v3\user1234</th>
      <th>2018-09-17</th>
      <td>0</td>
      <td>2018-09-17 23:11:00</td>
      <td>2018-09-18 06:29:30</td>
      <td>0 days 07:18:30</td>
    </tr>
    <tr>
      <th>2018-09-17</th>
      <td>2</td>
      <td>2018-09-18 16:11:00</td>
      <td>2018-09-18 16:40:30</td>
      <td>0 days 00:29:30</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">timing_data</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Sleep onset&quot;</span><span class="p">,</span> <span class="s2">&quot;Sleep offset&quot;</span><span class="p">,</span>
     <span class="s2">&quot;Sleep duration&quot;</span><span class="p">,</span> <span class="s2">&quot;Sleep onset MSLM&quot;</span><span class="p">,</span>
     <span class="s2">&quot;Sleep offset MSLM&quot;</span><span class="p">]</span>
    <span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sleep onset</th>
      <th>Sleep offset</th>
      <th>Sleep duration</th>
      <th>Sleep onset MSLM</th>
      <th>Sleep offset MSLM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018-06-25 20:55:30</td>
      <td>2018-06-26 06:51:00</td>
      <td>0 days 09:55:30</td>
      <td>1255.5</td>
      <td>411.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018-07-04 22:23:00</td>
      <td>2018-07-05 06:36:00</td>
      <td>0 days 08:13:00</td>
      <td>1343.0</td>
      <td>396.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018-07-05 23:27:00</td>
      <td>2018-07-06 06:29:00</td>
      <td>0 days 07:02:00</td>
      <td>1407.0</td>
      <td>389.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018-06-29 00:40:30</td>
      <td>2018-06-29 06:41:00</td>
      <td>0 days 06:00:30</td>
      <td>1480.5</td>
      <td>401.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2018-07-03 23:57:30</td>
      <td>2018-07-04 06:14:00</td>
      <td>0 days 06:16:30</td>
      <td>1437.5</td>
      <td>374.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

